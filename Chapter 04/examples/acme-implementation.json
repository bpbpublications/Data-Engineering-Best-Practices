{
    "service": "hadoop-hdfs",
    "policies": [{
        "name": "Users_Sales_Access",
        "resources": {"path": ["/public/reports"]},
        "groups": ["Users"],
        "permissions": [{
            "accesses": [{"type": "read", "isAllowed": true}]
        }],
        "conditions": [{
            "type": "tag",
            "values": ["Department=Sales", "Data_Classification=Public"]
        }],
        "description": "Sales managers read public reports"
    }, {
        "name": "DA_Analytics_Access",
        "resources": {"path": ["/data/analytics"]},
        "groups": ["DataAnalysts"],
        "permissions": [{
            "accesses": [{"type": "read", "isAllowed": true}]
        }],
        "conditions": [{
            "type": "tag",
            "values": ["Team=Finance", "Sensitivity=Low"]
        }],
        "description": "Finance DAs read low-sensitivity analytics data"
    }, {
        "name": "DE_Dev_Access",
        "resources": {"path": ["/data/processing"]},
        "groups": ["DataEngineers"],
        "permissions": [{
            "accesses": [
                {"type": "read", "isAllowed": true},
                {"type": "write", "isAllowed": true}
            ]
        }],
        "conditions": [{
            "type": "tag",
            "values": ["Environment=Dev"]
        }],
        "description": "DEs read/write in dev environment"
    }, {
        "name": "DS_StockPredictor_Access",
        "resources": {"path": ["/data/research"]},
        "groups": ["DataScientists"],
        "permissions": [{
            "accesses": [{"type": "read", "isAllowed": true}]
        }],
        "conditions": [{
            "type": "tag",
            "values": ["Project=StockPredictor"]
        }],
        "description": "DSs read stock prediction data"
    }, {
        "name": "Admin_Full_Access",
        "resources": {"path": ["/*"]},
        "groups": ["Admins"],
        "permissions": [{
            "accesses": [
                {"type": "read", "isAllowed": true},
                {"type": "write", "isAllowed": true},
                {"type": "execute", "isAllowed": true}
            ]
        }],
        "conditions": [{
            "type": "tag",
            "values": ["Action=Audit"]
        }],
        "description": "Admins with audit-only full access"
    }],
    "hive_policies": [{
        "name": "DA_Hive_Finance",
        "resources": {
            "database": ["analytics_db"],
            "table": ["finance_*"]
        },
        "groups": ["DataAnalysts"],
        "permissions": [{
            "accesses": [{"type": "select", "isAllowed": true}]
        }],
        "conditions": [{
            "type": "tag",
            "values": ["Team=Finance", "Sensitivity=Low"]
        }],
        "description": "Finance DAs query finance tables"
    }, {
        "name": "DS_Hive_Stock",
        "resources": {
            "database": ["research_db"],
            "table": ["predict_*"]
        },
        "groups": ["DataScientists"],
        "permissions": [{
            "accesses": [
                {"type": "select", "isAllowed": true},
                {"type": "update", "isAllowed": true}
            ]
        }],
        "conditions": [{
            "type": "tag",
            "values": ["Project=StockPredictor"]
        }],
        "description": "DSs manage stock prediction outputs"
    }]
}
